const fs = require('fs');
const path = require('path');

// Load the collection
const collectionPath = path.join(__dirname, '..', 'collections', 'hybrid-wood.json');
const collection = JSON.parse(fs.readFileSync(collectionPath, 'utf8'));

// Manually crafted natural Bulgarian descriptions for PLANK products
const plankDescriptions = {
    'FLR-5000': {
        name: 'Естествен Дъб Фин',
        description: 'Елегантен дъбов паркет с фина текстура и естествен топъл цвят. Водоустойчивата настилка съчетава красотата на истинското дърво с модерната издръжливост на хибридните технологии. Широките дъбови ламели създават усещане за простор и лукс. Идеален избор за съвременния дом - лесен за монтаж с клик система и поддръжка, подходящ за подово отопление. 25-годишна гаранция за спокойствие.',
        seoTitle: 'Естествен Дъбов Паркет Фин | Премиум Хибридно Дърво | Eco Vibe Floors',
        seoDescription: 'Елегантен естествен дъбов паркет с фина текстура. Водоустойчив, устойчив на драскотини, 25-годишна гаранция. Идеален за подово отопление. ⭐ Безплатна доставка.',
        imageAlt: 'Естествен дъбов паркет с фина текстура - премиум качество'
    },
    'FLR-5001': {
        name: 'Естествен Дъб Рустик',
        description: 'Автентичен дъбов паркет в рустик стил, който подчертава естествения характер на дървото. Изразителни годишни кръгове и възли придават уникална индивидуалност на всяка дъбова дъска. Водоустойчивата настилка е изключително здрава и дълготрайна. Топлата естествена визия се съчетава с лесна поддръжка и бърз монтаж благодарение на усъвършенстваната клик система. Перфектен за подово отопление.',
        seoTitle: 'Дъбов Паркет Рустик | Естествен Характер | Eco Vibe Floors',
        seoDescription: 'Автентичен дъбов паркет в рустик стил. Водоустойчив и траен, с уникална текстура. 25-годишна гаранция. ⭐ Подходящ за подово отопление.',
        imageAlt: 'Дъбов паркет рустик с естествена текстура и възли'
    },
    'FLR-5002': {
        name: 'Чист Дъб Фин',
        description: 'Изискан паркет от чист дъб със светла, изчистена визия и нежни нюанси. Широките паркетни ламели отразяват светлината и създават усещане за простор и свежест. Хибридната технология осигурява водоустойчивост и устойчивост на драскотини без компромис с естествената красота. Лесен монтаж с професионална клик система и минимална поддръжка. Отличен избор за модерни интериори с подово отопление.',
        seoTitle: 'Паркет Чист Дъб Фин | Светъл Естествен Дъбов Под | Eco Vibe Floors',
        seoDescription: 'Изискан светъл паркет от чист дъб. Водоустойчив и лесен за поддръжка. Професионален клик монтаж. 25-години гаранция. ⭐ Безплатна доставка.',
        imageAlt: 'Светъл паркет от чист дъб - фина обработка'
    },
    'FLR-5003': {
        name: 'Чист Дъб Рустик',
        description: 'Характерен дъбов паркет в рустик изпълнение, който носи топлината и автентичността на естественото дърво. Всяка дъбова дъска е с уникална текстура, възли и цветови вариации. Издържливата настилка съчетава традиционната естетика с модерна водоустойчивост. Бърз и лесен монтаж благодарение на иновативната клик система. Идеален за създаване на уютна атмосфера в съчетание с подово отопление.',
        seoTitle: 'Дъбов Паркет Чист Рустик | Автентична Текстура | Eco Vibe Floors',
        seoDescription: 'Характерен дъбов паркет рустик с автентична текстура. Водоустойчив, здрав и дълготраен. 25-год. гаранция. ⭐ За подово отопление.',
        imageAlt: 'Паркет чист дъб рустик - автентична дървена настилка'
    },
    'FLR-5004': {
        name: 'Опушен Бял Дъб Фин',
        description: 'Стилен паркет от опушен бял дъб с изтънчени сиви нюанси и елегантна визия. Специалната обработка придава на дървото уникален характер и модерна естетика. Паркетните ламели са водоустойчиви и устойчиви на драскотини, подходящи за натоварени помещения. Лесна поддръжка и бърз монтаж с клик система. Отличен избор за съвременни интериори с подово отопление и 25-годишна гаранция.',
        seoTitle: 'Паркет Опушен Бял Дъб | Стилен Сив Нюанс | Eco Vibe Floors',
        seoDescription: 'Елегантен паркет от опушен бял дъб със стилни сиви тонове. Водоустойчив и траен. Клик монтаж. 25-год. гаранция. ⭐ Безплатна доставка.',
        imageAlt: 'Опушен бял дъб паркет - модерен сив нюанс'
    },
    'FLR-5005': {
        name: 'Бял Дъб Фин',
        description: 'Изчистен паркет от бял дъб, който внася светлина и простор в интериора. Нежните светли тонове и фината текстура създават свежа и въздушна атмосфера. Дъбовите дъски са обработени с усъвършенствано PU покритие за водоустойчивост и лесна поддръжка. Бърз монтаж благодарение на професионалната клик система. Перфектен за скандинавски и минималистични стилове, съвместим с подово отопление.',
        seoTitle: 'Бял Дъбов Паркет Фин | Светъл Естествен Под | Eco Vibe Floors',
        seoDescription: 'Светъл паркет от бял дъб за модерни интериори. Водоустойчив, с лесна поддръжка. Клик система. 25-год. гаранция. ⭐ За подово отопление.',
        imageAlt: 'Бял дъбов паркет - светла елегантна настилка'
    },
    'FLR-5006': {
        name: 'Крем Дъб Фин',
        description: 'Топъл паркет от крем дъб с нежни бежови нюанси, които създават уютна и приветлива атмосфера. Естествените дъбови ламели носят топлина и елегантност във всяко помещение. Хибридната технология осигурява отлична водоустойчивост и издръжливост. Удобен клик монтаж и минимална поддръжка. Идеален за всекидневни, спални и офиси, напълно съвместим с подово отопление.',
        seoTitle: 'Паркет Крем Дъб | Топъл Бежов Нюанс | Eco Vibe Floors',
        seoDescription: 'Уютен паркет крем дъб с топли бежови тонове. Водоустойчив и лесен за поддръжка. Професионален монтаж. 25-год. гаранция. ⭐ Безплатна доставка.',
        imageAlt: 'Крем дъб паркет - топъл бежов нюанс'
    },
    'FLR-5007': {
        name: 'Черен Дъб Фин',
        description: 'Луксозен паркет от черен дъб с дълбоки тъмни тонове и изискана визия. Богатият цвят и фината текстура създават атмосфера на елегантност и престиж. Дъбовите дъски са обработени с висококачествено PU покритие за максимална защита и блясък. Водоустойчивата настилка е устойчива на драскотини и лесна за поддръжка. Отличен избор за луксозни интериори с подово отопление.',
        seoTitle: 'Черен Дъбов Паркет | Луксозна Тъмна Настилка | Eco Vibe Floors',
        seoDescription: 'Луксозен черен дъбов паркет с дълбоки тонове. Водоустойчив, устойчив на драскотини. Клик монтаж. 25-год. гаранция. ⭐ За подово отопление.',
        imageAlt: 'Черен дъбов паркет - луксозна тъмна настилка'
    },
    'FLR-5008': {
        name: 'Черен Дъб Рустик',
        description: 'Изразителен дъбов паркет в черен рустик стил с характерна текстура и натурални възли. Тъмните тонове се съчетават с автентичния рустик характер за уникална визия. Всяка паркетна ламела носи индивидуалността на естественото дърво. Водоустойчивата настилка е изключително здрава и подходяща за интензивна употреба. Лесен клик монтаж и съвместимост с подово отопление.',
        seoTitle: 'Черен Дъбов Паркет Рустик | Автентична Текстура | Eco Vibe Floors',
        seoDescription: 'Характерен черен дъбов паркет рустик. Автентична текстура, водоустойчив и траен. Клик система. 25-годишна гаранция. ⭐ Безплатна доставка.',
        imageAlt: 'Черен дъб рустик - характерна текстура и възли'
    },
    'FLR-5009': {
        name: 'Тъмен Дъб Фин',
        description: 'Елегантен паркет от тъмен дъб с наситени кафяви тонове и благородна визия. Фината обработка подчертава естествената красота на дървесината без да прикрива структурата. Дъбовите дъски осигуряват водоустойчивост и устойчивост на натоварване. Професионална клик система за бърз монтаж без усилие. Отличен избор за класически и модерни интериори с възможност за подово отопление.',
        seoTitle: 'Тъмен Дъбов Паркет | Благороден Кафяв Нюанс | Eco Vibe Floors',
        seoDescription: 'Елегантен тъмен дъбов паркет с наситени тонове. Водоустойчив и здрав. Лесен клик монтаж. 25-год. гаранция. ⭐ За подово отопление.',
        imageAlt: 'Тъмен дъбов паркет - благородна кафява настилка'
    },
    'FLR-5010': {
        name: 'Дъб Натурал Фин',
        description: 'Естествен паркет от дъб в натурален цвят, който запазва автентичната красота на дървото. Балансираните топли тонове са универсални и подходящи за всякакъв интериор. Паркетните ламели са с фина обработка и висококачествено защитно покритие. Водоустойчивата настилка е лесна за поддръжка и издържлива в ежедневната употреба. Бърз монтаж с клик система и пълна съвместимост с подово отопление.',
        seoTitle: 'Дъбов Паркет Натурал | Естествен Топъл Цвят | Eco Vibe Floors',
        seoDescription: 'Естествен дъбов паркет в натурален цвят. Универсален, водоустойчив и траен. Клик монтаж. 25-год. гаранция. ⭐ Безплатна доставка.',
        imageAlt: 'Дъб натурал паркет - естествен топъл цвят'
    },
    'FLR-5012': {
        name: 'Черен Дъб Рустик',
        description: 'Изразителен дъбов паркет в черен рустик стил с характерна текстура и натурални възли. Тъмните тонове се съчетават с автентичния рустик характер за уникална визия. Всяка паркетна ламела носи индивидуалността на естественото дърво. Водоустойчивата настилка е изключително здрава и подходяща за интензивна употреба. Лесен клик монтаж и съвместимост с подово отопление.',
        seoTitle: 'Черен Дъбов Паркет Рустик | Автентична Текстура | Eco Vibe Floors',
        seoDescription: 'Характерен черен дъбов паркет рустик. Автентична текстура, водоустойчив и траен. Клик система. 25-годишна гаранция. ⭐ Безплатна доставка.',
        imageAlt: 'Черен дъб рустик - характерна текстура и възли'
    },
    'FLR-5013': {
        name: 'Сив Дъб Рустик',
        description: 'Модерен дъбов паркет в сив рустик стил с характерна текстура и съвременна цветова гама. Сивите нюанси се съчетават с рустик структурата за уникален визуален ефект. Дъбовите дъски са водоустойчиви и устойчиви на драскотини. Лесна поддръжка и бърз клик монтаж без специални инструменти. Идеален за индустриални и скандинавски интериори със система за подово отопление.',
        seoTitle: 'Сив Дъбов Паркет Рустик | Модерна Текстура | Eco Vibe Floors',
        seoDescription: 'Модерен сив дъбов паркет рустик. Характерна текстура, водоустойчив и здрав. Клик система. 25-год. гаранция. ⭐ За подово отопление.',
        imageAlt: 'Сив дъб рустик - модерна сива настилка'
    }
};

// Manually crafted natural Bulgarian descriptions for FISHBONE products
const fishboneDescriptions = {
    'FLR-5016': {
        name: 'Бял Дъб',
        description: 'Изискан дъбов паркет рибена кост в светъл бял нюанс. Класическата подредба рибена кост създава елегантен визуален ефект и усещане за лукс. Естествените дъбови ламели са подредени в зигзагообразен модел, който внася динамика и стил. Водоустойчивата настилка съчетава традиционната естетика с модерна издръжливост. Лесен клик монтаж и 25-годишна гаранция. Перфектен за подово отопление.',
        seoTitle: 'Дъбов Паркет Рибена Кост Бял | Класическа Елегантност | Eco Vibe Floors',
        seoDescription: 'Елегантен бял дъбов паркет рибена кост. Класически дизайн, водоустойчив и траен. 25-год. гаранция. ⭐ Подходящ за подово отопление.',
        imageAlt: 'Бял дъбов паркет рибена кост - класическа елегантност'
    },
    'FLR-5014': {
        name: 'Крем Дъб',
        description: 'Топъл паркет рибена кост от крем дъб с уютни бежови тонове. Стилната подредба рибена кост на дъбовите ламели създава класически модел с модерна функционалност. Хибридната технология осигурява водоустойчивост без компромис с естествената красота. Лесна поддръжка и професионален клик монтаж. Идеален избор за елегантни интериори с възможност за подово отопление и дългогодишна гаранция.',
        seoTitle: 'Паркет Рибена Кост Крем Дъб | Топла Елегантност | Eco Vibe Floors',
        seoDescription: 'Уютен паркет рибена кост крем дъб. Класическа подредба, водоустойчив и лесен за поддръжка. 25-год. гаранция. ⭐ Безплатна доставка.',
        imageAlt: 'Крем дъб рибена кост - топъл класически паркет'
    },
    'FLR-5015': {
        name: 'Натурал Дъб',
        description: 'Естествен дъбов паркет рибена кост в натурален цвят, който запазва автентичността на дървото. Зигзагообразният модел на ламелите придава класическа изтънченост и визуална дълбочина. Балансираните топли тонове са универсални и подходящи за различни интериори. Водоустойчивата настилка е здрава и дълготрайна. Бърз клик монтаж и пълна съвместимост с подово отопление за максимален комфорт.',
        seoTitle: 'Дъбов Паркет Рибена Кост Натурал | Естествена Красота | Eco Vibe Floors',
        seoDescription: 'Естествен дъбов паркет рибена кост в натурален цвят. Класически модел, водоустойчив. 25-год. гаранция. ⭐ За подово отопление.',
        imageAlt: 'Натурал дъб рибена кост - естествена класика'
    },
    'FLR-5017': {
        name: 'Опушен Дъб',
        description: 'Стилен паркет рибена кост от опушен дъб с изтънчени сиви нюанси. Специалната обработка на дървото в съчетание с класическата подредба рибена кост създава модерна и изискана визия. Дъбовите ламели са водоустойчиви и устойчиви на драскотини. Лесна поддръжка и професионален клик монтаж. Отличен избор за съвременни и индустриални интериори с подово отопление.',
        seoTitle: 'Паркет Рибена Кост Опушен Дъб | Модерна Сива Елегантност | Eco Vibe Floors',
        seoDescription: 'Модерен паркет рибена кост опушен дъб. Стилни сиви тонове, водоустойчив и траен. 25-год. гаранция. ⭐ За подово отопление.',
        imageAlt: 'Опушен дъб рибена кост - модерна сива елегантност'
    },
    'FLR-5018': {
        name: 'Черен Дъб',
        description: 'Луксозен дъбов паркет рибена кост в черен цвят с дълбоки тъмни тонове. Класическата подредба на ламелите в зигзагообразен модел придава изключителна елегантност и престиж. Богатият цвят и рибена кост техниката създават впечатляващ визуален ефект. Водоустойчивата настилка е устойчива на драскотини и лесна за поддръжка. Перфектен за луксозни интериори с подово отопление.',
        seoTitle: 'Черен Дъбов Паркет Рибена Кост | Луксозна Елегантност | Eco Vibe Floors',
        seoDescription: 'Луксозен черен дъбов паркет рибена кост. Класическа подредба, водоустойчив. 25-год. гаранция. ⭐ За подово отопление.',
        imageAlt: 'Черен дъб рибена кост - луксозна класическа настилка'
    },
    'FLR-5019': {
        name: 'Тъмен Дъб',
        description: 'Благороден паркет рибена кост от тъмен дъб с наситени кафяви тонове и класическа визия. Елегантната подредба на дъбовите ламели в рибена кост създава усещане за традиционен лукс. Фината обработка подчертава естествената красота на дървесината. Водоустойчивата настилка е здрава и подходяща за интензивна употреба. Лесен монтаж с клик система и съвместимост с подово отопление.',
        seoTitle: 'Тъмен Дъбов Паркет Рибена Кост | Благородна Класика | Eco Vibe Floors',
        seoDescription: 'Благороден тъмен дъбов паркет рибена кост. Класическа елегантност, водоустойчив. 25-год. гаранция. ⭐ За подово отопление.',
        imageAlt: 'Тъмен дъб рибена кост - благородна класическа настилка'
    }
};

// Priority keywords to add naturally
const commonKeywords = {
    plank: [
        'естествен паркет',
        'дъбов паркет',
        'паркет софия',
        'дъбови ламели',
        'паркетни дъски',
        'купи паркет',
        'цена на паркет',
        'хибриден паркет',
        'водоустойчив паркет',
        'паркет за подово отопление'
    ],
    fishbone: [
        'паркет рибена кост',
        'рибена кост от дъб',
        'дъбов паркет рибена кост',
        'естествен паркет рибена кост',
        'класически паркет рибена кост',
        'купи паркет рибена кост',
        'цена рибена кост',
        'паркет рибена кост софия',
        'дъбови ламели рибена кост',
        'луксозен паркет рибена кост'
    ]
};

// Process each product
collection.products.forEach((product) => {
    const isFishbone = product.pattern === 'fishbone';
    const isPlank = product.pattern === 'plank';

    if (!product.i18n || !product.i18n.bg) return;

    const sku = product.sku;
    const bg = product.i18n.bg;

    // Get manually crafted content
    const newContent = isFishbone ? fishboneDescriptions[sku] : plankDescriptions[sku];

    if (!newContent) {
        console.log(`⚠️  No manual content for SKU: ${sku}`);
        return;
    }

    // Update with manually crafted natural Bulgarian
    bg.name = newContent.name;
    bg.description = newContent.description;

    if (bg.seo) {
        bg.seo.title = newContent.seoTitle;
        bg.seo.description = newContent.seoDescription;

        // Enhance keywords naturally
        if (bg.seo.keywords && Array.isArray(bg.seo.keywords)) {
            // Remove old "право редене"
            bg.seo.keywords = bg.seo.keywords.filter(k =>
                k !== 'право редене под' &&
                k !== 'право редене'
            );

            // Add priority keywords naturally (if not already present)
            const keywordsToAdd = isFishbone ? commonKeywords.fishbone : commonKeywords.plank;
            keywordsToAdd.forEach(keyword => {
                if (!bg.seo.keywords.includes(keyword)) {
                    bg.seo.keywords.push(keyword);
                }
            });

            // Limit to reasonable number
            if (bg.seo.keywords.length > 15) {
                bg.seo.keywords = bg.seo.keywords.slice(0, 15);
            }
        }
    }

    // Update image alt text
    if (product.imageAlt) {
        product.imageAlt.bg = newContent.imageAlt;
    }

    console.log(`✅ Updated ${sku} - ${newContent.name}`);
});

// Update metadata
collection.metadata.lastRefined = new Date().toISOString();
collection.metadata.refinementNote = 'Manually rewritten Bulgarian texts with natural language';

// Save
fs.writeFileSync(collectionPath, JSON.stringify(collection, null, 4), 'utf8');

console.log(`\n🎉 Successfully rewrote all 18 products with natural Bulgarian!`);
